<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/jng" href="./assets/favicon.jng">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>mood board</title>
    
    <!-- Link to your new CSS file -->
    <link rel="stylesheet" href="style.css">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <!-- FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@300;400;700&family=Indie+Flower&family=Patrick+Hand&family=Permanent+Marker&family=Shadows+Into+Light&display=swap" rel="stylesheet">
</head>
<body class="is-locked"> 

    <div id="lockBtn" class="lock-fab locked" onclick="toggleLockMode()">ğŸ”’</div>

    <div id="mySidebar" class="sidebar">
        <a href="javascript:void(0)" class="close-btn" onclick="toggleNav()">Ã—</a>
        <div style="text-align:center; font-size:2rem; margin-bottom:20px;">ğŸ“… Weeks</div>
        <div id="sidebar-weeks-list"></div>
        <div class="sidebar-section">
            <div class="sidebar-title">ğŸ“Œ Pinboards</div>
            <button class="sidebar-btn create-board-btn" onclick="createNewBoard()">+ Create Board</button>
            <div id="sidebar-boards-list"></div>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title" onclick="openStatsModal()" style="cursor:pointer; background:#e1f5fe; padding:10px; border-radius:10px; text-align:center;">ğŸ“Š View Mood Stats</div>
        </div>
        <button class="sidebar-btn" onclick="openSettingsModal()">âš™ï¸ Settings</button>
    </div>

    <button class="hamburger" onclick="toggleNav()">â˜°</button>
    
    <div class="header-container"><img id="mainTitleImage" class="main-header-img" alt="Mood Board"></div>

    <div id="weeks-container"></div>

    <div id="pinterest-container">
        <div class="pinterest-header">
            <h2 id="pinboard-title" class="pinterest-title">
                <span id="board-name-display">My Board</span>
                <span class="edit-title-btn" onclick="renameCurrentBoard()">âœ</span>
            </h2>
            <div class="board-actions" style="justify-content: center; margin-top:10px;">
                <button class="action-btn btn-note" onclick="openNoteEditor(activeBoardId)">ğŸ“ Sticky</button>
                <button class="action-btn btn-draw" onclick="openDrawModal(activeBoardId)">ğŸ¨ Paint</button>
                <button class="action-btn btn-bg" onclick="openBgModal(activeBoardId)">ğŸ–¼ï¸ BG</button>
                <button class="action-btn btn-export" onclick="exportBoardAsPNG()">ğŸ“¸ Save Image</button>
            </div>
        </div>
        <div class="board-container pinterest-board" id="active-board-container">
            <div class="board-inner" id="active-board-inner" onclick="deselectAll(event)"></div>
        </div>
    </div>

    <div id="overlay" onclick="closeAllModals()"></div>

    <!-- EDITOR MODAL -->
    <div id="noteEditorModal" class="modal">
        <div class="editor-container-row">
            <div class="note-editor" id="noteEditorPreview">
                <div class="editor-tape" id="editorTapePreview"></div>
                <textarea id="editorText" placeholder="Dear Diary..." autofocus></textarea>
                <div class="editor-footer">
                    <div id="moodGrid" class="mood-grid"></div>
                    <input type="file" id="editorFileInput" accept="image/*" style="display:none;" onchange="handleFileSelect(this)">
                    <div class="editor-photo-box" onclick="document.getElementById('editorFileInput').click()">
                        <span class="editor-photo-label" id="photoLabel">+ Pic</span>
                        <img id="editorImgPreview" src="" alt="preview">
                    </div>
                </div>
            </div>
            <div class="editor-sidebar">
                <div class="editor-tabs">
                    <div class="tab-btn active" onclick="setEditorTab('tape')">ğŸï¸</div>
                    <div class="tab-btn" onclick="setEditorTab('paper')">ğŸ“„</div>
                    <div class="tab-btn" onclick="setEditorTab('font')">ğŸ”¤</div>
                </div>
                <div id="tab-tape" class="customize-grid">
                    <input type="file" id="tapeUpload" accept="image/*" style="display:none;" onchange="handleAssetUpload(this, 'tape')">
                    <div class="upload-btn-style" onclick="document.getElementById('tapeUpload').click()">+</div>
                </div>
                <div id="tab-paper" class="customize-grid" style="display:none;">
                    <input type="file" id="paperUpload" accept="image/*" style="display:none;" onchange="handleAssetUpload(this, 'paper')">
                    <div class="upload-btn-style" onclick="document.getElementById('paperUpload').click()">+</div>
                </div>
                <div id="tab-font" class="customize-grid" style="display:none;">
                    <input type="color" id="fontColorPicker" value="#444444" onchange="applyFontColor(this.value)" style="width:100%; height:30px; border:none; cursor:pointer;">
                </div>
            </div>
        </div>
        <div class="editor-buttons">
            <button class="cancel-btn" onclick="closeAllModals()">Cancel</button>
            <button class="save-btn" onclick="saveFromEditor('note')">Stick It! ğŸ“Œ</button>
        </div>
        <div class="sticker-mode-area">
            <div class="sticker-link" onclick="saveFromEditor('sticker')">Or save as Transparent Sticker</div>
            <div class="sticker-option">
                <input type="checkbox" id="stickerBorderCheck" checked> 
                <label for="stickerBorderCheck">Add White Outline?</label>
            </div>
        </div>
    </div>

    <!-- DRAW MODAL -->
    <div id="drawModal" class="modal">
        <div class="modal-draw-content">
            <h3 id="drawModalTitle" style="margin:0 0 10px 0; text-align:center;">Art Studio ğŸ¨</h3>
            <div class="brush-rack">
                <div class="brush-btn active" onclick="setBrush('pen', this)">ğŸ–Šï¸</div>
                <div class="brush-btn" onclick="setBrush('marker', this)">ğŸ–ï¸</div>
                <div class="brush-btn" onclick="setBrush('spray', this)">ğŸ’¨</div>
                <div class="brush-btn" onclick="setBrush('eraser', this)">ğŸ§¼</div>
                <div class="brush-btn" onclick="toggleColorPicker()" style="background:#444; color:white;">ğŸŒˆ</div>
            </div>
            <div id="ibisPicker" class="ibis-picker-container" style="display:none;">
                <div class="picker-area">
                    <div class="hue-ring" id="hueRing"><div class="hue-indicator" id="hueInd"></div></div>
                    <div class="sv-square" id="svSquare"><div class="sv-white"><div class="sv-black"></div></div><div class="sv-indicator" id="svInd"></div></div>
                </div>
                <div style="display:flex; align-items:center; gap:10px; width:100%;">
                    <div class="preview-box" id="colorPreview"></div>
                    <div style="flex-grow:1; display:flex; flex-direction:column; gap:5px;">
                        <div class="slider-row"><span style="color:red">R</span> <input type="range" class="color-slider" id="rSlider" min="0" max="255" style="background: linear-gradient(to right, black, red);"></div>
                        <div class="slider-row"><span style="color:green">G</span> <input type="range" class="color-slider" id="gSlider" min="0" max="255" style="background: linear-gradient(to right, black, green);"></div>
                        <div class="slider-row"><span style="color:blue">B</span> <input type="range" class="color-slider" id="bSlider" min="0" max="255" style="background: linear-gradient(to right, black, blue);"></div>
                    </div>
                </div>
                <button onclick="toggleColorPicker()" style="width:100%; padding:5px; background:#666; color:white; border:none;">Close</button>
            </div>
            <div class="canvas-container"><canvas id="drawCanvas"></canvas></div>
            <div style="margin-top:10px;">
                <label>Size: <span id="sizeVal">5</span>px</label>
                <input type="range" id="drawSize" min="1" max="30" value="5" style="width:100%; accent-color:var(--c-accent);">
            </div>
            <div style="display:flex; justify-content:space-between; margin-top:10px;">
                <button onclick="clearCanvas()" style="background:#ffcdd2; border:none; padding:5px 10px; border-radius:5px;">Clear</button>
                <button onclick="saveDrawing()" style="background:#c8e6c9; border:none; padding:5px 15px; border-radius:5px; font-weight:bold;">Done!</button>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal"><div class="confirm-box" style="width:340px;"><h3>âš™ï¸ Settings</h3><p style="color:#777; font-size:1rem;">Danger Zone</p><button onclick="askHardReset()" style="width:100%; padding:15px; background:#ef5350; color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">âš ï¸ DELETE EVERYTHING</button><br><br><button class="cancel-btn" style="width:100%" onclick="closeAllModals()">Close</button></div></div>
    <div id="confirmModal" class="modal"><div class="confirm-box"><div class="confirm-msg" id="confirmMsg">Are you sure?</div><div class="confirm-actions"><button class="cancel-btn" onclick="closeConfirm(false)">No</button><button class="save-btn" style="background:#ef5350; color:white;" onclick="closeConfirm(true)">Yes</button></div></div></div>
    <div id="statsModal" class="modal"><div class="stats-box"><h3 style="text-align:center; margin-top:0;">Mood Statistics ğŸ“ˆ</h3><div id="statsContent"></div><br><button class="cancel-btn" style="width:100%" onclick="closeAllModals()">Close</button></div></div>
    
    <!-- BACKGROUND MODAL -->
    <div id="bgModal" class="modal">
        <div class="modal-draw-content" style="text-align:center;">
            <h3>Choose Background ğŸ–¼ï¸</h3>
            <div id="bg-list-container" class="bg-grid-container"></div>
            <input type="file" id="bgAssetUpload" accept="image/*" style="display:none;" onchange="handleBgAssetUpload(this)">
            <br>
            <button class="cancel-btn" onclick="closeAllModals()">Close</button>
        </div>
    </div>

    <!-- Link to your new JS file -->
    <script src="script.js"></script>
</body>
</html>

